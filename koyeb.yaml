services:
  - name: api
    type: web
    dockerfile: Dockerfile
    ports:
      - port: 8000
    env:
      - name: PORT
        value: "8000"
      - name: PYTHONUNBUFFERED
        value: "1"
    healthcheck:
      path: /healthz
      interval: 30
      timeout: 10
    scaling:
      min: 1  # Keep at least 1 instance always running (prevents deep sleep)
      max: 3

  - name: worker
    type: worker
    dockerfile: Dockerfile.worker
    env:
      - name: PYTHONUNBUFFERED
        value: "1"
    scaling:
      min: 1
      max: 2
    # No health check needed - workers are not HTTP services
    # Command is in Dockerfile.worker CMD

